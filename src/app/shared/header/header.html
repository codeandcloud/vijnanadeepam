<header class="max-w-7xl mx-auto header shadow-lg playfair-display-600">
    <div class="flex items-center justify-between h-12">
        <h1 class="header-title">
            <a routerLink="/home"
               aria-label="Vijnanadeepam home">
                <span aria-hidden="true">{{title}}</span>
            </a>
        </h1>

        <nav class="hidden lg:flex items-center gap-2">
            @for (item of menuItems; track item.label) {
            @if(item.children) {
            <div class="nav-menu">
                <button class="nav-link"
                        type="button"
                        (click)="toggleDropdown(item.label)">
                    <span>{{item.label}}</span>
                    <i class="fas fa-chevron-down ms-2 text-sm transition-transform"
                       [class.rotate-180]="currentOpenMenu() === item.label"></i>
                </button>
                <div class="nav-submenu shadow-lg"
                     [class.opacity-0]="currentOpenMenu() !== item.label"
                     [class.opacity-100]="currentOpenMenu() === item.label"
                     [class.invisible]="currentOpenMenu() !== item.label"
                     [class.visible]="currentOpenMenu() === item.label">
                    @for(subItem of item.children; track subItem.label) {
                    <a [routerLink]="subItem.link"
                       routerLinkActive="active"
                       (click)="closeDropdown()"
                       class="nav-link">
                        {{subItem.label}}
                    </a>
                    }
                </div>
            </div>
            } @else {
            <a [routerLink]="item.link"
               routerLinkActive="active"
               class="nav-link">
                {{item.label}}
            </a>
            }
            }
        </nav>
        <div class="flex items-center gap-2">
            <!-- Mobile Menu Button -->
            <div class="lg:hidden">
                <button (click)="toggleMobileMenu()"
                        aria-label="Toggle menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <!-- Theme Toggle Button -->
            <vd-menu-toggler></vd-menu-toggler>
        </div>
    </div>

    <!-- Mobile Navigation Menu -->
    <div class="lg:hidden"
         [class.hidden]="!isMobileMenuOpen">
        <nav class="mobile-menu">
            @for (item of menuItems; track item.label) {
            @if(item.children) {
            <!-- Mobile Dropdown Section -->
            <div class="py-2">
                <div class="text-gray-600">
                    {{item.label}}
                </div>
                <div class="pl-4 space-y-1">
                    @for(subItem of item.children; track subItem.label) {
                    <a [routerLink]="subItem.link"
                       routerLinkActive="active"
                       (click)="closeMobileMenu()"
                       class="nav-link">
                        {{subItem.label}}
                    </a>
                    }
                </div>
            </div>
            } @else {
            <a [routerLink]="item.link"
               routerLinkActive="active"
               (click)="closeMobileMenu()"
               class="nav-link">
                {{item.label}}
            </a>
            }
            }

            <!-- Theme Toggle in Mobile Menu -->
            <div class="py-2 border-t border-gray-200 mt-2">
                <vd-menu-toggler></vd-menu-toggler>
            </div>
        </nav>
    </div>
</header>